<!DOCTYPE html>
<html>
<head>
  <title>HT Messenger - Chat</title>
  <style>
    #chat { height: 400px; overflow-y: scroll; border: 1px solid #ccc; padding: 10px; }
    .msg-left { text-align: left; background: #eee; margin: 5px; padding: 5px; border-radius: 5px; }
    .msg-right { text-align: right; background: #8ecae6; color: white; margin: 5px; padding: 5px; border-radius: 5px; }
  </style>
</head>
<body>

<h2>Conversation</h2>
<div id="chat"></div>
<input id="msg" placeholder="Ã‰crire un message">
<button id="send">Envoyer</button>

<script type="module">
  import { loadMessages } from "./js/messages-list.js";
  import { sendMessage } from "./js/messages.js";

  const urlParams = new URLSearchParams(window.location.search);
  const convId = urlParams.get("convId");

  loadMessages(convId, document.getElementById("chat"));
  import { markAsRead } from "./js/messages.js";

// Marquer les messages comme lus quand on ouvre le chat
markAsRead(convId);

  send.onclick = () => {
    const content = msg.value.trim();
    if (!content) return;
    sendMessage(convId, content);
    msg.value = "";
  };
</script>

</body>
</html>
